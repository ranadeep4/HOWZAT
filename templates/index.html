{% extends 'base.html' %}
{% block title %}Howzat{% endblock %}

{% block content %}

<div class="site-card">
    <div class="card-header">
        <div>
            <h2>IPL Score Predictor</h2>
            <p class="sub-text">Predict finishing totals with model confidence</p>
        </div>
        <a href="/rag" class="btn-accent">Ask IPLX</a>
    </div>

    <div class="grid">
        <!-- FORM -->
        <form action="/predict" method="post" class="form-section">

            <div class="form-group">
                <label>Batting Team</label>
                <select name="bat_team">
                    <option value="">Select Batting Team</option>
                    {% for t in options.bat_team %}
                        <option value="{{ t }}" {% if form and form.bat_team==t %}selected{% endif %}>{{ t }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label>Bowling Team</label>
                <select name="bowl_team">
                    <option value="">Select Bowling Team</option>
                    {% for t in options.bowl_team %}
                        <option value="{{ t }}" {% if form and form.bowl_team==t %}selected{% endif %}>{{ t }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label>Venue</label>
                <select name="venue">
                    <option value="">Select Venue</option>
                    {% for v in options.venue %}
                        <option value="{{ v }}" {% if form and form.venue==v %}selected{% endif %}>{{ v }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label>Runs so far</label>
                <input name="runs" type="number" value="{{ form.runs if form else 0 }}">
            </div>

            <div class="form-group">
                <label>Wickets so far</label>
                <input name="wickets" type="number" value="{{ form.wickets if form else 0 }}">
            </div>

            <div class="form-group">
                <label>Overs completed</label>
                <input name="overs" type="number" step="0.1" value="{{ form.overs if form else 0.0 }}">
            </div>

            <div class="form-group">
                <label>Striker (0/1)</label>
                <input name="striker" type="number" value="{{ form.striker if form else 0 }}">
            </div>

            <div class="form-group">
                <label>Batsman</label>
                <select name="batsman">
                    <option value="">Select Batsman</option>
                    {% for p in options.batsman %}
                        <option value="{{ p }}" {% if form and form.batsman==p %}selected{% endif %}>{{ p }}</option>
                    {% endfor %}
                </select>
            </div>

            <div class="form-group">
                <label>Bowler</label>
                <select name="bowler">
                    <option value="">Select Bowler</option>
                    {% for p in options.bowler %}
                        <option value="{{ p }}" {% if form and form.bowler==p %}selected{% endif %}>{{ p }}</option>
                    {% endfor %}
                </select>
            </div>

            <button class="btn-accent" type="submit">Predict</button>

        </form>

        <!-- RESULTS -->
        <div class="result-section">
            {% if errors %}
                <div class="alert">
                    <h4>Validation Errors</h4>
                    <ul>
                        {% for e in errors %}
                        <li>{{ e }}</li>
                        {% endfor %}
                    </ul>
                </div>
            {% endif %}

            {% if prediction is defined %}
                <div class="prediction-box">
                    <p class="muted">Predicted Total</p>
                    <p class="prediction-number">{{ prediction }}</p>
                    <p class="tiny muted">Model estimate â€” for guidance only</p>
                </div>
            {% else %}
                <div class="prediction-box">
                    <p class="muted">Prediction will appear here after submitting the form</p>
                </div>
            {% endif %}

            <div class="tip-card">
                <h4>Tips</h4>
                <ul>
                    <li>Provide at least 5 overs of data</li>
                    <li>Use exact team/player names</li>
                    <li>Unknown players are managed by fallback encoding</li>
                </ul>
            </div>
        </div>

    </div>
</div>

{% endblock %}
